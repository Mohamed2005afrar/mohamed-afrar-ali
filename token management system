using System;
using System.Collections.Generic;
namespace TokenManagementSystem
{
    public class ServiceToken
    {
        private static int _tokenCounter = 1000;
        public int TokenID { get; private set; }
        public int Position { get; set; }
        public DateTime TicketDateTime { get; set; }
        public string Status { get; set; }
        public ServiceToken(int position)
        {
            TokenID = ++_tokenCounter;
            Position = position;
            TicketDateTime = DateTime.Now;
            Status = "Pending";
        }
    }
    public class TicketManager
    {
        public Queue<ServiceToken> TokenQueue { get; set; }
        public TicketManager()
        {
            TokenQueue = new Queue<ServiceToken>();
        }
        public void GenerateServiceToken()
        {
            ServiceToken token = new ServiceToken(TokenQueue.Count + 1);
            TokenQueue.Enqueue(token);
            Console.WriteLine($"Token Generated Successfully. Token ID: {token.TokenID}");
        }
        public ServiceToken GetNextToken()
        {
            if (TokenQueue.Count == 0)
            {
                Console.WriteLine("No tokens available.");
                return null;
            }
            ServiceToken token = TokenQueue.Peek();
            Console.WriteLine($"Next Token: {token.TokenID}");
            return token;
        }
        public void UpdateToken(int tokenID)
        {
            bool found = false;
            foreach (var token in TokenQueue)
            {
                if (token.TokenID == tokenID)
                {
                    token.Status = "Completed";
                    Console.WriteLine($"Token {tokenID} marked as Completed.");
                    found = true;
                    break;
                }
            }
           if (!found)
            {
                Console.WriteLine("Token not found.");
            }
        }
        public ServiceToken SkipToken()
        {
            if (TokenQueue.Count < 2)
            {
                Console.WriteLine("Not enough tokens to skip.");
                return null;
            }
            ServiceToken skipped = TokenQueue.Dequeue();
            TokenQueue.Enqueue(skipped);
            ServiceToken nextToken = TokenQueue.Peek();
            Console.WriteLine($"Skipped Token {skipped.TokenID}. Next Token is {nextToken.TokenID}");
            return nextToken;
        }
        public void ListAllTokens()
        {
            if (TokenQueue.Count == 0)
            {
                Console.WriteLine("No tokens available.");
                return;
            }
            Console.WriteLine("\nTokenID\tPosition\tDate & Time\t\tStatus");
            foreach (var token in TokenQueue)
            {
                Console.WriteLine($"{token.TokenID}\t{token.Position}\t\t{token.TicketDateTime}\t{token.Status}");
            }
        }
    }
    class Program
    {
        static void Main(string[] args)
        {
            TicketManager manager = new TicketManager();
            int choice;
            do
            {
                Console.WriteLine("TOKEN MANAGEMENT SYSTEM");
                Console.WriteLine("******************************");
                Console.WriteLine("1. Create Token");
                Console.WriteLine("2. Get Next Token");
                Console.WriteLine("3. Update Token");
                Console.WriteLine("4. Skip Token");
                Console.WriteLine("5. List all tokens");
                Console.WriteLine("6. Exit");
                Console.Write("Enter your Choice: ");
                choice = Convert.ToInt32(Console.ReadLine());
                switch (choice)
                {
                    case 1:
                        manager.GenerateServiceToken();
                        break;
                    case 2:
                        manager.GetNextToken();
                        break;
                    case 3:
                        Console.Write("Enter Token ID to update: ");
                        int id = Convert.ToInt32(Console.ReadLine());
                        manager.UpdateToken(id);
                        break;
                    case 4:
                        manager.SkipToken();
                        break;
                    case 5:
                        manager.ListAllTokens();
                        break;
                    case 6:
                        Console.WriteLine("Exiting application...");
                        break;
                    default:
                        Console.WriteLine("Invalid choice. Try again.");
                        break;
                }
            } while (choice != 6);
        }
    }
}
